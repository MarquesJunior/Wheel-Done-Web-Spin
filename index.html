<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Wheel Done — Driver Simulator</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

<style>
  :root{
    --brand-yellow:#ffc107;
    --brand-black:#000000;
    --brand-white:#ffffff;
    --neutral-gray:#e5e5e5;
  }
  html,body{height:100%}
  body{
    margin:0;
    background:#000 url("https://images.unsplash.com/photo-1503376780353-7e6692767b70?q=80&w=1920&auto=format&fit=crop") center/cover no-repeat fixed;
    color:#111;
    overflow-x:hidden;
  }

  /* ======= HOME ======= */
  #homeScreen{min-height:100dvh; position:relative;}
  .header-home{position:relative; padding:2rem 1rem; text-align:center; color:#fff;}
  .user-icon{
    position:fixed; top:1rem; right:1rem; z-index:20;
    width:44px; height:44px; border-radius:50%;
    border:2px solid #fff; background:#000; color:#fff;
    display:flex; align-items:center; justify-content:center;
  }
  .hero-text{ color:#fff; text-align:center; margin-bottom:1rem; }
  .hero-text .main-title{ font-weight:800; letter-spacing:.5px; }

  .video-section{ background:#ffffff; border-radius:16px; padding:1rem; border:2px solid #000; }
  .video-title{ color:#000; margin-top:.5rem; font-weight:700; }
  .video-description{ color:#333; }

  /* player + overlay de clique */
  #highlightVideo .col-12.col-lg-7{ position:relative; }
  .video-preview{ width:100%; border-radius:12px; background:#000; min-height:220px; border:2px solid #000; }
  .preview-tapzone{
    position:absolute; inset:0; border:0; padding:0; margin:0; background:transparent; cursor:pointer;
  }

  .thumb-list{
    display:flex; gap:.75rem; overflow-x:auto; padding:.75rem .25rem;
    scroll-snap-type:x mandatory;
    -webkit-overflow-scrolling:touch;
  }
  .thumb-item{
    width:140px; height:88px; object-fit:cover; border-radius:10px;
    scroll-snap-align:center; cursor:pointer; flex:0 0 auto;
    border:2px solid #000;
  }

  .download-buttons{ display:flex; gap:.75rem; justify-content:center; }
  .playstore-btn, .appstore-btn{ font-weight:700; }

  .join-claim-section{
    position:fixed; left:0; right:0; bottom:0; z-index:15;
    display:flex; flex-direction:column; align-items:center; gap:.35rem;
    padding:.5rem .75rem .75rem;
  }
  .next-spin-text{ color:#fff; font-size:.9rem; }
  .fixed-bottom-btn{
    display:inline-flex; align-items:center; gap:.5rem; justify-content:center;
    width:min(680px, 94vw);
    background:var(--brand-yellow);
    color:#000; border:2px solid #000; font-weight:800; padding:.9rem 1.2rem; border-radius:999px;
  }

  /* ======= FEED ======= */
  #feedScreen{ display:none; position:fixed; inset:0; background:#000; z-index:30; }
  .feed-container{ position:relative; width:100%; height:100%; overflow:hidden; background:#000; }
  #feedVideo.feed-video{ width:100%; height:100%; }
  .feed-actions{
    position:absolute; right:12px; top:50%; transform:translateY(-50%);
    display:flex; flex-direction:column; align-items:center; gap:.65rem; color:#fff;
  }
  .feed-actions button{
    background:#000; border:2px solid #fff; color:#fff;
    width:52px; height:52px; border-radius:12px; display:grid; place-items:center; font-size:1.35rem;
  }
  .feed-actions .count{ font-size:.95rem; }
  #backBtn{
    position:absolute; top:12px; left:12px; z-index:5;
    background:#000; color:#fff; border:2px solid #fff; border-radius:999px; padding:.35rem .7rem;
  }
  .progress-bar-container{ position:absolute; left:0; right:0; bottom:0; height:5px; background:#ddd; }
  .progress-bar-fill{ height:100%; width:0%; background:var(--brand-yellow); }

  .feed-tapzone{ position:absolute; inset:0; }

  /* ======= POPUP LOGIN (PARCIAL, CENTRALIZADO, SEM TRANSPARÊNCIA) ======= */
  .popup-login{
    position:fixed; inset:auto; display:none; z-index:40;
    left:50%; top:50%; transform:translate(-50%, -50%);
    width:min(92vw, 520px); max-height:min(86vh, 720px);
    background:#ffffff; color:#000; border:3px solid #000; border-radius:20px;
    overflow:hidden;
    box-shadow: 0 10px 0 #000; /* sombra sólida */
  }
  .popup-login .header{
    display:flex; justify-content:space-between; align-items:center;
    padding:1rem; border-bottom:3px solid #000; background:#fff;
  }
  .btn-close{
    width:40px; height:40px; border-radius:50%; border:3px solid #000;
    background:#000; color:#fff; display:grid; place-items:center;
  }
  .popup-login .content{ padding:1rem; }
  .reward-text{ color:#111; }
  .reward-icons{ display:flex; gap:.75rem; font-size:1.35rem; margin:.5rem 0; color:#000; }
  .next-reward-time{ color:#000; font-weight:800; }
  .btn-login-google, .btn-login-apple{
    width:100%; background:var(--brand-yellow); border:3px solid #000; color:#000; font-weight:800;
  }

  /* ======= RESPONSIVO ======= */
  /* Espaço extra entre os botões de download e o botão Join & Claim no mobile */
  @media (max-width: 991.98px){
    #downloadButtons{ margin-bottom: 7rem; } /* ~altura do botão fixo + respiro */
    /* Ocultar título e descrição do vídeo na Home (mantidos no DOM para SEO) */
    .video-title, .video-description{ display:none !important; }
  }
  @media (min-width: 992px){
    /* Desktop: título e descrição visíveis */
    .video-title, .video-description{ display:block; }
  }

  /* ======= UTIL ======= */
  .visually-hidden{ position:absolute !important; clip:rect(1px,1px,1px,1px); padding:0 !important; border:0 !important; height:1px !important; width:1px !important; overflow:hidden; }
</style>
</head>
<body>

<!-- =================== HOME =================== -->
<div id="homeScreen">
  <header class="header-home">
    <h1 class="hero-text mb-1">
      <span class="main-title h1 d-block">Wheel Done</span>
      <small class="subtitle">Mobile car simulator with clutch and manual gear</small>
    </h1>
    <button id="userIcon" class="user-icon" aria-label="Login"><i class="bi bi-person"></i></button>
  </header>

  <main class="container pb-5">
    <!-- Seção Video Destaque -->
    <section id="highlightVideo" class="video-section">
      <div class="row g-3 align-items-stretch">
        <div class="col-12 col-lg-7">
          <!-- Player YouTube + overlay de clique -->
          <div id="previewVideo" class="video-preview"></div>
          <button id="previewTap" class="preview-tapzone" aria-label="Abrir feed"><span class="visually-hidden">Abrir feed</span></button>
        </div>
        <div class="col-12 col-lg-5 d-flex flex-column">
          <h4 class="video-title">Manual Mastery — Clutch & Gear Control</h4>
          <p class="video-description">
            Sinta a embreagem, troque marchas no tempo perfeito e domine as ruas.
            Essa seção mostra o vídeo em destaque; toque para abrir o feed vertical.
          </p>
          <!-- Carrossel de thumbs -->
          <div id="videoCarousel" class="thumb-list mt-auto">
            <img class="thumb-item" src="https://img.youtube.com/vi/dQw4w9WgXcQ/hqdefault.jpg" data-ytid="dQw4w9WgXcQ" alt="thumb 1">
            <img class="thumb-item" src="https://img.youtube.com/vi/9bZkp7q19f0/hqdefault.jpg" data-ytid="9bZkp7q19f0" alt="thumb 2">
            <img class="thumb-item" src="https://img.youtube.com/vi/e-ORhEE9VVg/hqdefault.jpg" data-ytid="e-ORhEE9VVg" alt="thumb 3">
            <img class="thumb-item" src="https://img.youtube.com/vi/3JZ_D3ELwOQ/hqdefault.jpg" data-ytid="3JZ_D3ELwOQ" alt="thumb 4">
          </div>
        </div>
      </div>
    </section>

    <!-- Download Buttons -->
    <section id="downloadButtons" class="download-buttons my-4">
      <a href="#" class="btn btn-dark playstore-btn"><i class="bi bi-google-play"></i> Play Store</a>
      <a href="#" class="btn btn-secondary appstore-btn"><i class="bi bi-apple"></i> App Store</a>
    </section>
  </main>

  <!-- Join & Claim fixo -->
  <section id="joinAndClaim" class="join-claim-section">
    <p id="nextSpinText" class="next-spin-text">next spin restart: <span id="nextSpinEta">20h57m</span></p>
    <button id="joinClaimBtn" class="fixed-bottom-btn">
      <i class="bi bi-gift-fill"></i> Join and Claim
    </button>
  </section>
</div>

<!-- =================== FEED =================== -->
<div id="feedScreen" role="dialog" aria-modal="true">
  <div id="feedContainer" class="feed-container">
    <button id="backBtn" class="btn" aria-label="Voltar"><i class="bi bi-arrow-left"></i> Back</button>

    <!-- contêiner do player YT no feed -->
    <div id="feedVideo" class="feed-video"></div>
    <div class="feed-tapzone" id="feedTap"></div>

    <div class="feed-actions">
      <button id="likeBtn" aria-label="Curtir"><i class="bi bi-heart-fill"></i></button>
      <div id="likeCount" class="count">0</div>
      <button id="shareBtn" class="mt-1" aria-label="Compartilhar"><i class="bi bi-share-fill"></i></button>
      <div id="shareCount" class="count">0</div>
    </div>

    <div class="progress-bar-container">
      <div class="progress-bar-fill"></div>
    </div>
  </div>
</div>

<!-- =================== POPUP LOGIN (PARCIAL) =================== -->
<aside id="loginPopup" class="popup-login" role="dialog" aria-modal="true" aria-labelledby="loginTitle">
  <div class="header">
    <h5 id="loginTitle" class="m-0">Entre para receber recompensas</h5>
    <button id="closeLoginPopup" class="btn-close" aria-label="Fechar"><i class="bi bi-x-lg"></i></button>
  </div>
  <div class="content">
    <p id="rewardText" class="reward-text">
      Recompensas diárias, giros extras e itens exclusivos. Faça login e resgate seus prêmios agora mesmo!
    </p>
    <div class="reward-icons" aria-hidden="true">
      <i class="bi bi-gift-fill"></i>
      <i class="bi bi-joystick"></i>
      <i class="bi bi-lightning-charge-fill"></i>
    </div>
    <p id="nextRewardTime" class="next-reward-time">Próximo resgate em: 20h57m</p>
    <div class="d-grid gap-2 mt-3">
      <button id="loginGoogle" class="btn btn-login-google"><i class="bi bi-google"></i> Entrar com Google</button>
      <button id="loginApple" class="btn btn-login-apple"><i class="bi bi-apple"></i> Entrar com Apple</button>
    </div>
    <div class="text-center mt-2" style="font-size:.9rem;">Ao continuar, você concorda com os Termos.</div>
  </div>
</aside>

<script src="https://www.youtube.com/iframe_api"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
  /* ===== Config ===== */
  const PREVIEW_SECONDS = 6; // pré-visualização de 6s
  let isLoggedIn = false;
  const ytVideos = ["dQw4w9WgXcQ","9bZkp7q19f0","e-ORhEE9VVg","3JZ_D3ELwOQ"];
  let currentIndex = 0;

  /* ===== ETA "next spin" fake ===== */
  const nextSpinEtaEl = document.getElementById('nextSpinEta');
  let etaMinutes = 20*60 + 57;
  function updateEta(){
    if(etaMinutes<0) return;
    const h = Math.floor(etaMinutes/60);
    const m = etaMinutes%60;
    nextSpinEtaEl.textContent = `${String(h).padStart(2,'0')}h${String(m).padStart(2,'0')}m`;
    etaMinutes--;
  }
  updateEta();
  setInterval(updateEta, 60_000);

  /* ===== YouTube Players ===== */
  let previewPlayer, feedPlayer, previewStopTimer=null;

  window.onYouTubeIframeAPIReady = function(){
    previewPlayer = new YT.Player('previewVideo', {
      videoId: ytVideos[0],
      playerVars: {
        playsinline:1, controls:1, rel:0, modestbranding:1,
        autoplay:1, mute:1
      },
      events: { 'onReady': onPreviewReady }
    });

    feedPlayer = new YT.Player('feedVideo', {
      videoId: ytVideos[currentIndex],
      playerVars: { playsinline:1, controls:0, rel:0, modestbranding:1 },
      events: { 'onReady': onFeedReady }
    });
  };

  function onPreviewReady(){
    try{ previewPlayer.mute(); }catch(e){}
    try{ previewPlayer.playVideo(); }catch(e){}
    if (PREVIEW_SECONDS > 0) {
      clearTimeout(previewStopTimer);
      previewPlayer.seekTo(0, true);
      previewStopTimer = setTimeout(()=>{ previewPlayer.pauseVideo(); }, PREVIEW_SECONDS*1000);
    }

    // Thumbs trocam o vídeo
    document.querySelectorAll('#videoCarousel .thumb-item').forEach(img=>{
      img.addEventListener('click', ()=>{
        const id = img.getAttribute('data-ytid');
        previewPlayer.loadVideoById(id, 0, "hd1080");
        if (PREVIEW_SECONDS > 0) {
          clearTimeout(previewStopTimer);
          previewPlayer.playVideo();
          previewStopTimer = setTimeout(()=>{ previewPlayer.pauseVideo(); }, PREVIEW_SECONDS*1000);
        }
      });
    });

    // Overlay abre Feed com o mesmo vídeo
    document.getElementById('previewTap').addEventListener('click', ()=>{
      const vid = previewPlayer?.getVideoData()?.video_id || ytVideos[0];
      openFeed(vid);
    });
  }

  function onFeedReady(){
    try{ feedPlayer.mute(); }catch(e){}
    startFeedProgressLoop();
  }

  /* ===== Feed ===== */
  const feedScreen = document.getElementById('feedScreen');
  const backBtn = document.getElementById('backBtn');

  function openFeed(videoId){
    feedScreen.style.display = 'block';
    document.body.style.overflow = 'hidden';
    const idx = ytVideos.indexOf(videoId);
    currentIndex = idx >= 0 ? idx : 0;
    feedPlayer.loadVideoById(ytVideos[currentIndex], 0, "hd1080");
    try{ feedPlayer.playVideo(); }catch(e){}
  }
  function closeFeed(){
    feedScreen.style.display = 'none';
    document.body.style.overflow = '';
    try{ feedPlayer.pauseVideo(); }catch(e){}
  }
  backBtn.addEventListener('click', closeFeed);

  // Barra de progresso (indicador apenas)
  const progressFill = document.querySelector('.progress-bar-fill');
  let progressLoop = null;
  function startFeedProgressLoop(){
    clearInterval(progressLoop);
    progressLoop = setInterval(()=>{
      if(!feedPlayer || typeof feedPlayer.getDuration!=="function") return;
      const dur = feedPlayer.getDuration() || 0;
      const cur = feedPlayer.getCurrentTime? feedPlayer.getCurrentTime() : 0;
      const p = dur ? (cur/dur)*100 : 0;
      progressFill.style.width = p + '%';
    }, 200);
  }

  // Pause/Play no toque central do feed
  document.getElementById('feedTap').addEventListener('click', ()=>{
    const s = feedPlayer.getPlayerState();
    if(s === YT.PlayerState.PLAYING){ feedPlayer.pauseVideo(); }
    else { feedPlayer.playVideo(); }
  });

  // Ações com gate de login
  const likeBtn = document.getElementById('likeBtn');
  const shareBtn = document.getElementById('shareBtn');
  const likeCount = document.getElementById('likeCount');
  const shareCount = document.getElementById('shareCount');

  likeBtn.addEventListener('click', ()=>{
    if(!isLoggedIn) return openLogin();
    likeCount.textContent = (+likeCount.textContent + 1);
  });
  shareBtn.addEventListener('click', ()=>{
    if(!isLoggedIn) return openLogin();
    shareCount.textContent = (+shareCount.textContent + 1);
  });

  // Swipe com animação que acompanha o dedo
  const feedContainer = document.getElementById('feedContainer');
  let startY = 0, currentY = 0, swiping = false;

  feedContainer.addEventListener('touchstart', (e)=>{
    swiping = true;
    startY = e.touches[0].clientY;
    currentY = startY;
    document.getElementById('feedVideo').style.transition = 'none';
  }, {passive:true});

  feedContainer.addEventListener('touchmove', (e)=>{
    if(!swiping) return;
    currentY = e.touches[0].clientY;
    const dy = currentY - startY;
    document.getElementById('feedVideo').style.transform = `translateY(${dy}px)`;
  }, {passive:true});

  feedContainer.addEventListener('touchend', ()=>{
    if(!swiping) return;
    swiping = false;
    const dy = currentY - startY;
    const el = document.getElementById('feedVideo');
    el.style.transition = 'transform .25s ease';
    const threshold = 100;

    if(dy < -threshold && currentIndex < ytVideos.length-1){
      // próximo
      currentIndex++;
      el.style.transform = 'translateY(-100%)';
      setTimeout(()=>{
        feedPlayer.loadVideoById(ytVideos[currentIndex], 0, "hd1080");
        el.style.transform = 'translateY(0)';
      }, 250);
    } else if(dy > threshold && currentIndex > 0){
      // anterior
      currentIndex--;
      el.style.transform = 'translateY(100%)';
      setTimeout(()=>{
        feedPlayer.loadVideoById(ytVideos[currentIndex], 0, "hd1080");
        el.style.transform = 'translateY(0)';
      }, 250);
    } else {
      el.style.transform = 'translateY(0)';
    }
  });

  /* ===== Popup Login (parcial) ===== */
  const loginPopup = document.getElementById('loginPopup');
  const closeLoginPopup = document.getElementById('closeLoginPopup');
  const userIcon = document.getElementById('userIcon');

  function openLogin(){
    loginPopup.style.display = 'block';
  }
  function closeLogin(){
    loginPopup.style.display = 'none';
  }

  userIcon.addEventListener('click', openLogin);
  closeLoginPopup.addEventListener('click', closeLogin);

  document.getElementById('loginGoogle').addEventListener('click', ()=>{
    isLoggedIn = true; closeLogin(); alert('Logado com Google (simulação)');
  });
  document.getElementById('loginApple').addEventListener('click', ()=>{
    isLoggedIn = true; closeLogin(); alert('Logado com Apple (simulação)');
  });

  // Join & Claim: abre login se não autenticado
  document.getElementById('joinClaimBtn').addEventListener('click', ()=>{
    if(!isLoggedIn) return openLogin();
    alert('Prêmio resgatado! (simulação)');
  });

  // ESC fecha popup
  document.addEventListener('keydown', (e)=>{
    if(e.key === 'Escape' && loginPopup.style.display==='block') closeLogin();
  });
</script>
</body>
</html>
